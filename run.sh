#!/bin/bash

commands=(
    "ectf_build_depl -d ."
    "ectf_build_ap -d . -on ap -od build -p 521313 -t 0123456789abcdef -c 2 -ids '0x12344321, 0x43211234' -b 'Ap boot ready'"
    "ectf_build_comp -d . -on comp1 -od build -id 0x12344321 -b 'Component 1 Boot' -al co -ad 03/02/2024 -ac raja"
    "ectf_build_comp -d . -on comp2 -od build -id 0x43211234 -b 'Component 2 Boot' -al co -ad 03/02/2024 -ac raja"
    "ectf_update --infile build/ap.img --port /dev/tty.usbmodem1433302"
    "ectf_update --infile build/comp1.img --port /dev/tty.usbmodem1433202"
    "ectf_update --infile build/comp2.img --port /dev/tty.usbmodem1433102"
    "ectf_list -a /dev/tty.usbmodem1433302"
    "ectf_attestation -a /dev/tty.usbmodem1433302 -p 521313 -c 0x12344321"
    "ectf_attestation -a /dev/tty.usbmodem1433302 -p 5211313 -c 0x43211234"
    "ectf_attestation -a /dev/tty.usbmodem1433302 -p 521313 -c 0x43211234"
    #"ectf_boot -a /dev/tty.usbmodem1433302"
    #"ectf_replace -a /dev/tty.usbmodem1433302 -t 0123456789abcdefg -i 0x -o"
)
width=$(tput cols)


for cmd in "${commands[@]}"; do
    cmd_name=$(echo "$cmd" | cut -d ' ' -f 1)
    printf '\e[93;1m.................................................................................................................................................................\e[0m\n'
    echo "Executing command: $cmd_name"
    printf '\e[93;1m.................................................................................................................................................................\e[0m\n'
    printf '\033[93;1m█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████\033[0m'
    printf '\e[93;1m.................................................................................................................................................................\e[0m\n'
    echo "Executing command: $cmd"
    printf '\e[93;1m.................................................................................................................................................................\e[0m\n'
    say --quality 127 -r 130 -v Whisper "Now, Executing $cmd_name"
    eval "$cmd"
    printf '\e[93;1m.................................................................................................................................................................\e[0m\n'
    printf '\e[93;1m.................................................................................................................................................................\e[0m\n'
    say --quality 127 -r 130 -v Whisper "Command $cmd_name execution, complete."
    printf '\033[93;1m█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████\033[0m'
    echo -e "\n"
    printf '\033[93;1m█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████\033[0m'
    echo -e "\n"
    printf '\033[93;1m█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████\033[0m'
    echo -e "\n"
    sleep 5 
done
say --quality 127 -r 130 -v Whisper "All execution complete, output ready for evaluation."